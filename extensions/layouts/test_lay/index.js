import{defineComponent as e,toRefs as t,resolveComponent as l,openBlock as i,createElementBlock as o,createVNode as r,withCtx as a,createCommentVNode as s,computed as n,unref as d}from"vue";import{useStores as u,defineLayout as c,useSync as f,useCollection as m,useItems as p}from"@directus/extensions-sdk";const v={class:"layout-tabular"};var y=e({__name:"layout",props:{collection:{type:String,required:!0},items:{type:Array,required:!0},tableHeaders:{type:Array,required:!0}},setup(e){t(e),console.log("<--------------- JK Layout ---------------\x3e");const{useCollectionsStore:n}=u();return console.log(u()),console.log(n()),(t,n)=>{const d=l("v-table");return i(),o("div",v,[r(d,{ref:"table",class:"table","show-resize":"","must-sort":"",items:e.items,"selection-use-keys":""},{default:a((()=>[s(' <template v-for="header in tableHeaders" :key="header.value" #[`item.${header.value}`]="{ item }">\n\t\t\t\t<render-display\n\t\t\t\t\t:value="getFromAliasedItem(item, header.value)"\n\t\t\t\t\t:display="header.field.display"\n\t\t\t\t\t:options="header.field.displayOptions"\n\t\t\t\t\t:interface="header.field.interface"\n\t\t\t\t\t:interface-options="header.field.interfaceOptions"\n\t\t\t\t\t:type="header.field.type"\n\t\t\t\t\t:collection="header.field.collection"\n\t\t\t\t\t:field="header.field.field"\n\t\t\t\t/>\n\t\t\t</template> ')])),_:1},8,["items"])])}}});function g(e,t,l){return n({get(){var i,o;return null!=(o=null==(i=e.value)?void 0:i[t])?o:d(l)},set(l){e.value=Object.assign({},e.value,{[t]:l})}})}y.__file="src/layout.vue";var h=c({id:"test_lay",name:"Test lay",icon:"box",component:y,slots:{options:()=>null,sidebar:()=>null,actions:()=>null},setup(e,{emit:l}){const i=f(e,"layoutQuery",l),{collection:o,filter:r,filterUser:a,search:s}=t(e),{info:d,primaryKeyField:u,fields:c,sortField:v}=m(o),{sort:y,limit:h,page:b,fields:x}=function(){const e=g(i,"page",1),t=g(i,"limit",25),l=n((()=>{var e;return u.value?[null==(e=u.value)?void 0:e.field]:[]})),o=g(i,"sort",l),r=n((()=>c.value.filter((e=>{var t;return!(null==(t=e.meta)?void 0:t.hidden)})).slice(0,4).map((({field:e})=>e)).sort())),a=g(i,"fields",r);return{sort:o,limit:t,page:e,fields:a}}();console.log({sort:y,limit:h,page:b,fields:x});const _={fields:x,limit:h,sort:y,search:s,filter:r,page:b},{items:C,loading:I,error:k,totalPages:q,itemCount:A,totalCount:F,changeManualSort:K,getItems:O,getItemCount:S,getTotalCount:H}=p(o,_);return console.log("<--------------- JK Index ---------------\x3e"),console.log(C),{items:C}}});export{h as default};
